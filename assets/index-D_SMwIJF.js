import{e as k,b4 as p,r as T,o as B,w as M,O as R,P as g,a as C,l as h,W as O,aT as H}from"./index-DFzFKJ1X.js";function S(e){return typeof e=="string"?document.querySelector(e):e()}function y(e){return e instanceof HTMLElement}function w(e){for(let u=0;u<e.childNodes.length;u++){const r=e.childNodes[u];if(y(r)&&(A(r)||w(r)))return!0}return!1}function I(e){for(let u=e.childNodes.length-1;u>=0;u--){const r=e.childNodes[u];if(y(r)&&(A(r)||I(r)))return!0}return!1}function A(e){if(!P(e))return!1;try{e.focus({preventScroll:!0})}catch{}return document.activeElement===e}function P(e){if(e.tabIndex>0||e.tabIndex===0&&e.getAttribute("tabIndex")!==null)return!0;if(e.getAttribute("disabled"))return!1;switch(e.nodeName){case"A":return!!e.href&&e.rel!=="ignore";case"INPUT":return e.type!=="hidden"&&e.type!=="file";case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}}let o=[];const _=k({name:"FocusTrap",props:{disabled:Boolean,active:Boolean,autoFocus:{type:Boolean,default:!0},onEsc:Function,initialFocusTo:String,finalFocusTo:String,returnFocusOnDeactivated:{type:Boolean,default:!0}},setup(e){const u=p(),r=T(null),E=T(null);let f=!1,i=!1;const b=typeof document>"u"?null:document.activeElement;function l(){return o[o.length-1]===u}function d(t){var n;t.code==="Escape"&&l()&&((n=e.onEsc)===null||n===void 0||n.call(e,t))}B(()=>{M(()=>e.active,t=>{t?(N(),R("keydown",document,d)):(g("keydown",document,d),f&&m())},{immediate:!0})}),C(()=>{g("keydown",document,d),f&&m()});function F(t){if(!i&&l()){const n=v();if(n===null||n.contains(H(t)))return;a("first")}}function v(){const t=r.value;if(t===null)return null;let n=t;for(;n=n.nextSibling,!(n===null||n instanceof Element&&n.tagName==="DIV"););return n}function N(){var t;if(!e.disabled){if(o.push(u),e.autoFocus){const{initialFocusTo:n}=e;n===void 0?a("first"):(t=S(n))===null||t===void 0||t.focus({preventScroll:!0})}f=!0,document.addEventListener("focus",F,!0)}}function m(){var t;if(e.disabled||(document.removeEventListener("focus",F,!0),o=o.filter(c=>c!==u),l()))return;const{finalFocusTo:n}=e;n!==void 0?(t=S(n))===null||t===void 0||t.focus({preventScroll:!0}):e.returnFocusOnDeactivated&&b instanceof HTMLElement&&(i=!0,b.focus({preventScroll:!0}),i=!1)}function a(t){if(l()&&e.active){const n=r.value,c=E.value;if(n!==null&&c!==null){const s=v();if(s==null||s===c){i=!0,n.focus({preventScroll:!0}),i=!1;return}i=!0;const L=t==="first"?w(s):I(s);i=!1,L||(i=!0,n.focus({preventScroll:!0}),i=!1)}}}function x(t){if(i)return;const n=v();n!==null&&(t.relatedTarget!==null&&n.contains(t.relatedTarget)?a("last"):a("first"))}function D(t){i||(t.relatedTarget!==null&&t.relatedTarget===r.value?a("last"):a("first"))}return{focusableStartRef:r,focusableEndRef:E,focusableStyle:"position: absolute; height: 0; width: 0;",handleStartFocus:x,handleEndFocus:D}},render(){const{default:e}=this.$slots;if(e===void 0)return null;if(this.disabled)return e();const{active:u,focusableStyle:r}=this;return h(O,null,[h("div",{"aria-hidden":"true",tabindex:u?"0":"-1",ref:"focusableStartRef",style:r,onFocus:this.handleStartFocus}),e(),h("div",{"aria-hidden":"true",style:r,ref:"focusableEndRef",tabindex:u?"0":"-1",onFocus:this.handleEndFocus})])}});export{_ as F};
//# sourceMappingURL=index-D_SMwIJF.js.map
