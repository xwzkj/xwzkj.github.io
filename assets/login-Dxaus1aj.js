import{x as W,c as O,j as T,o as _,aT as x,am as F,aA as j,aB as q,k as J,aV as Z,aW as Q,aX as tt,B as L,C as D,u as B,P as et,S as U,a5 as ot,at as nt,au as st,al as Y}from"./index-OS7v5Vwz.js";import{_ as it}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as rt,b as at,e as lt,u as X,g as ct,h as ut}from"./light-BN_uxXOF.js";import"./isArguments-I_hyfNLX.js";const ht=rt([at("qr-code",`
 background: #fff;
 border-radius: var(--n-border-radius);
 display: inline-flex;
 `)]),dt=h=>({borderRadius:h.borderRadius}),ft={name:"QrCode",common:lt,self:dt};var N;(function(h){class r{static encodeText(t,o){const e=h.QrSegment.makeSegments(t);return r.encodeSegments(e,o)}static encodeBinary(t,o){const e=h.QrSegment.makeBytes(t);return r.encodeSegments([e],o)}static encodeSegments(t,o,e=1,n=40,s=-1,f=!0){if(!(r.MIN_VERSION<=e&&e<=n&&n<=r.MAX_VERSION)||s<-1||s>7)throw new RangeError("Invalid value");let i,u;for(i=e;;i++){const a=r.getNumDataCodewords(i,o)*8,m=c.getTotalBits(t,i);if(m<=a){u=m;break}if(i>=n)throw new RangeError("Data too long")}for(const a of[r.Ecc.MEDIUM,r.Ecc.QUARTILE,r.Ecc.HIGH])f&&u<=r.getNumDataCodewords(i,a)*8&&(o=a);const d=[];for(const a of t){l(a.mode.modeBits,4,d),l(a.numChars,a.mode.numCharCountBits(i),d);for(const m of a.getData())d.push(m)}const w=r.getNumDataCodewords(i,o)*8;l(0,Math.min(4,w-d.length),d),l(0,(8-d.length%8)%8,d);for(let a=236;d.length<w;a^=253)l(a,8,d);const E=[];for(;E.length*8<d.length;)E.push(0);return d.forEach((a,m)=>E[m>>>3]|=a<<7-(m&7)),new r(i,o,E,s)}constructor(t,o,e,n){if(this.version=t,this.errorCorrectionLevel=o,this.modules=[],this.isFunction=[],t<r.MIN_VERSION||t>r.MAX_VERSION)throw new RangeError("Version value out of range");if(n<-1||n>7)throw new RangeError("Mask value out of range");this.size=t*4+17;const s=[];for(let i=0;i<this.size;i++)s.push(!1);for(let i=0;i<this.size;i++)this.modules.push(s.slice()),this.isFunction.push(s.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(e);if(this.drawCodewords(f),n===-1){let i=1e9;for(let u=0;u<8;u++){this.applyMask(u),this.drawFormatBits(u);const d=this.getPenaltyScore();d<i&&(n=u,i=d),this.applyMask(u)}}this.mask=n,this.applyMask(n),this.drawFormatBits(n),this.isFunction=[]}getModule(t,o){return t>=0&&t<this.size&&o>=0&&o<this.size&&this.modules[o][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2===0),this.setFunctionModule(e,6,e%2===0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),o=t.length;for(let e=0;e<o;e++)for(let n=0;n<o;n++)e===0&&n===0||e===0&&n===o-1||e===o-1&&n===0||this.drawAlignmentPattern(t[e],t[n]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const o=this.errorCorrectionLevel.formatBits<<3|t;let e=o;for(let s=0;s<10;s++)e=e<<1^(e>>>9)*1335;const n=(o<<10|e)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,M(n,s));this.setFunctionModule(8,7,M(n,6)),this.setFunctionModule(8,8,M(n,7)),this.setFunctionModule(7,8,M(n,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,M(n,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,M(n,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,M(n,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let e=0;e<12;e++)t=t<<1^(t>>>11)*7973;const o=this.version<<12|t;for(let e=0;e<18;e++){const n=M(o,e),s=this.size-11+e%3,f=Math.floor(e/3);this.setFunctionModule(s,f,n),this.setFunctionModule(f,s,n)}}drawFinderPattern(t,o){for(let e=-4;e<=4;e++)for(let n=-4;n<=4;n++){const s=Math.max(Math.abs(n),Math.abs(e)),f=t+n,i=o+e;f>=0&&f<this.size&&i>=0&&i<this.size&&this.setFunctionModule(f,i,s!==2&&s!==4)}}drawAlignmentPattern(t,o){for(let e=-2;e<=2;e++)for(let n=-2;n<=2;n++)this.setFunctionModule(t+n,o+e,Math.max(Math.abs(n),Math.abs(e))!==1)}setFunctionModule(t,o,e){this.modules[o][t]=e,this.isFunction[o][t]=!0}addEccAndInterleave(t){const o=this.version,e=this.errorCorrectionLevel;if(t.length!==r.getNumDataCodewords(o,e))throw new RangeError("Invalid argument");const n=r.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][o],s=r.ECC_CODEWORDS_PER_BLOCK[e.ordinal][o],f=Math.floor(r.getNumRawDataModules(o)/8),i=n-f%n,u=Math.floor(f/n),d=[],w=r.reedSolomonComputeDivisor(s);for(let a=0,m=0;a<n;a++){const R=t.slice(m,m+u-s+(a<i?0:1));m+=R.length;const I=r.reedSolomonComputeRemainder(R,w);a<i&&R.push(0),d.push(R.concat(I))}const E=[];for(let a=0;a<d[0].length;a++)d.forEach((m,R)=>{(a!==u-s||R>=i)&&E.push(m[a])});return E}drawCodewords(t){if(t.length!==Math.floor(r.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let o=0;for(let e=this.size-1;e>=1;e-=2){e===6&&(e=5);for(let n=0;n<this.size;n++)for(let s=0;s<2;s++){const f=e-s,u=(e+1&2)===0?this.size-1-n:n;!this.isFunction[u][f]&&o<t.length*8&&(this.modules[u][f]=M(t[o>>>3],7-(o&7)),o++)}}}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let o=0;o<this.size;o++)for(let e=0;e<this.size;e++){let n;switch(t){case 0:n=(e+o)%2===0;break;case 1:n=o%2===0;break;case 2:n=e%3===0;break;case 3:n=(e+o)%3===0;break;case 4:n=(Math.floor(e/3)+Math.floor(o/2))%2===0;break;case 5:n=e*o%2+e*o%3===0;break;case 6:n=(e*o%2+e*o%3)%2===0;break;case 7:n=((e+o)%2+e*o%3)%2===0;break;default:throw new Error("Unreachable")}!this.isFunction[o][e]&&n&&(this.modules[o][e]=!this.modules[o][e])}}getPenaltyScore(){let t=0;for(let s=0;s<this.size;s++){let f=!1,i=0;const u=[0,0,0,0,0,0,0];for(let d=0;d<this.size;d++)this.modules[s][d]===f?(i++,i===5?t+=r.PENALTY_N1:i>5&&t++):(this.finderPenaltyAddHistory(i,u),f||(t+=this.finderPenaltyCountPatterns(u)*r.PENALTY_N3),f=this.modules[s][d],i=1);t+=this.finderPenaltyTerminateAndCount(f,i,u)*r.PENALTY_N3}for(let s=0;s<this.size;s++){let f=!1,i=0;const u=[0,0,0,0,0,0,0];for(let d=0;d<this.size;d++)this.modules[d][s]===f?(i++,i===5?t+=r.PENALTY_N1:i>5&&t++):(this.finderPenaltyAddHistory(i,u),f||(t+=this.finderPenaltyCountPatterns(u)*r.PENALTY_N3),f=this.modules[d][s],i=1);t+=this.finderPenaltyTerminateAndCount(f,i,u)*r.PENALTY_N3}for(let s=0;s<this.size-1;s++)for(let f=0;f<this.size-1;f++){const i=this.modules[s][f];i===this.modules[s][f+1]&&i===this.modules[s+1][f]&&i===this.modules[s+1][f+1]&&(t+=r.PENALTY_N2)}let o=0;for(const s of this.modules)o=s.reduce((f,i)=>f+(i?1:0),o);const e=this.size*this.size,n=Math.ceil(Math.abs(o*20-e*10)/e)-1;return t+=n*r.PENALTY_N4,t}getAlignmentPatternPositions(){if(this.version===1)return[];{const t=Math.floor(this.version/7)+2,o=this.version===32?26:Math.ceil((this.version*4+4)/(t*2-2))*2,e=[6];for(let n=this.size-7;e.length<t;n-=o)e.splice(1,0,n);return e}}static getNumRawDataModules(t){if(t<r.MIN_VERSION||t>r.MAX_VERSION)throw new RangeError("Version number out of range");let o=(16*t+128)*t+64;if(t>=2){const e=Math.floor(t/7)+2;o-=(25*e-10)*e-55,t>=7&&(o-=36)}return o}static getNumDataCodewords(t,o){return Math.floor(r.getNumRawDataModules(t)/8)-r.ECC_CODEWORDS_PER_BLOCK[o.ordinal][t]*r.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");const o=[];for(let n=0;n<t-1;n++)o.push(0);o.push(1);let e=1;for(let n=0;n<t;n++){for(let s=0;s<o.length;s++)o[s]=r.reedSolomonMultiply(o[s],e),s+1<o.length&&(o[s]^=o[s+1]);e=r.reedSolomonMultiply(e,2)}return o}static reedSolomonComputeRemainder(t,o){const e=o.map(n=>0);for(const n of t){const s=n^e.shift();e.push(0),o.forEach((f,i)=>e[i]^=r.reedSolomonMultiply(f,s))}return e}static reedSolomonMultiply(t,o){if(t>>>8||o>>>8)throw new RangeError("Byte out of range");let e=0;for(let n=7;n>=0;n--)e=e<<1^(e>>>7)*285,e^=(o>>>n&1)*t;return e}finderPenaltyCountPatterns(t){const o=t[1],e=o>0&&t[2]===o&&t[3]===o*3&&t[4]===o&&t[5]===o;return(e&&t[0]>=o*4&&t[6]>=o?1:0)+(e&&t[6]>=o*4&&t[0]>=o?1:0)}finderPenaltyTerminateAndCount(t,o,e){return t&&(this.finderPenaltyAddHistory(o,e),o=0),o+=this.size,this.finderPenaltyAddHistory(o,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(t,o){o[0]===0&&(t+=this.size),o.pop(),o.unshift(t)}}r.MIN_VERSION=1,r.MAX_VERSION=40,r.PENALTY_N1=3,r.PENALTY_N2=3,r.PENALTY_N3=40,r.PENALTY_N4=10,r.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],r.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],h.QrCode=r;function l(g,t,o){if(t<0||t>31||g>>>t)throw new RangeError("Value out of range");for(let e=t-1;e>=0;e--)o.push(g>>>e&1)}function M(g,t){return(g>>>t&1)!==0}class c{static makeBytes(t){const o=[];for(const e of t)l(e,8,o);return new c(c.Mode.BYTE,t.length,o)}static makeNumeric(t){if(!c.isNumeric(t))throw new RangeError("String contains non-numeric characters");const o=[];for(let e=0;e<t.length;){const n=Math.min(t.length-e,3);l(parseInt(t.substr(e,n),10),n*3+1,o),e+=n}return new c(c.Mode.NUMERIC,t.length,o)}static makeAlphanumeric(t){if(!c.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");const o=[];let e;for(e=0;e+2<=t.length;e+=2){let n=c.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e))*45;n+=c.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e+1)),l(n,11,o)}return e<t.length&&l(c.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e)),6,o),new c(c.Mode.ALPHANUMERIC,t.length,o)}static makeSegments(t){return t===""?[]:c.isNumeric(t)?[c.makeNumeric(t)]:c.isAlphanumeric(t)?[c.makeAlphanumeric(t)]:[c.makeBytes(c.toUtf8ByteArray(t))]}static makeEci(t){const o=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)l(t,8,o);else if(t<16384)l(2,2,o),l(t,14,o);else if(t<1e6)l(6,3,o),l(t,21,o);else throw new RangeError("ECI assignment value out of range");return new c(c.Mode.ECI,0,o)}static isNumeric(t){return c.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return c.ALPHANUMERIC_REGEX.test(t)}constructor(t,o,e){if(this.mode=t,this.numChars=o,this.bitData=e,o<0)throw new RangeError("Invalid argument");this.bitData=e.slice()}getData(){return this.bitData.slice()}static getTotalBits(t,o){let e=0;for(const n of t){const s=n.mode.numCharCountBits(o);if(n.numChars>=1<<s)return 1/0;e+=4+s+n.bitData.length}return e}static toUtf8ByteArray(t){t=encodeURI(t);const o=[];for(let e=0;e<t.length;e++)t.charAt(e)!=="%"?o.push(t.charCodeAt(e)):(o.push(parseInt(t.substr(e+1,2),16)),e+=2);return o}}c.NUMERIC_REGEX=/^[0-9]*$/,c.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+./:-]*$/,c.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",h.QrSegment=c})(N||(N={}));(function(h){(function(r){class l{constructor(c,g){this.ordinal=c,this.formatBits=g}}l.LOW=new l(0,1),l.MEDIUM=new l(1,0),l.QUARTILE=new l(2,3),l.HIGH=new l(3,2),r.Ecc=l})(h.QrCode||(h.QrCode={}))})(N||(N={}));(function(h){(function(r){class l{constructor(c,g){this.modeBits=c,this.numBitsCharCount=g}numCharCountBits(c){return this.numBitsCharCount[Math.floor((c+7)/17)]}}l.NUMERIC=new l(1,[10,12,14]),l.ALPHANUMERIC=new l(2,[9,11,13]),l.BYTE=new l(4,[8,16,16]),l.KANJI=new l(8,[8,10,12]),l.ECI=new l(7,[0,0,0]),r.Mode=l})(h.QrSegment||(h.QrSegment={}))})(N||(N={}));const mt={L:N.QrCode.Ecc.LOW,M:N.QrCode.Ecc.MEDIUM,Q:N.QrCode.Ecc.QUARTILE,H:N.QrCode.Ecc.HIGH},gt=Object.assign(Object.assign({},X.props),{value:String,color:{type:String,default:"#000"},backgroundColor:{type:String,default:"#FFF"},iconSrc:String,iconSize:{type:Number,default:40},iconBackgroundColor:{type:String,default:"#FFF"},iconBorderRadius:{type:Number,default:4},size:{type:Number,default:100},padding:{type:[Number,String],default:12},errorCorrectionLevel:{type:String,default:"M"},type:{type:String,default:"canvas"}}),$=2,Et=W({name:"QrCode",props:gt,setup(h){const{mergedClsPrefixRef:r,inlineThemeDisabled:l}=ct(h),M=X("QrCode","-qr-code",ht,ft,h,r),c=O(()=>({"--n-border-radius":M.value.self.borderRadius})),g=l?ut("qr-code",void 0,c,h):void 0,t=T(),o=O(()=>{var i;const u=mt[h.errorCorrectionLevel];return N.QrCode.encodeText((i=h.value)!==null&&i!==void 0?i:"-",u)});_(()=>{const i=T(0);let u=null;x(()=>{h.type!=="svg"&&(i.value,e(o.value,h.size,h.color,h.backgroundColor,u?{icon:u,iconBorderRadius:h.iconBorderRadius,iconSize:h.iconSize,iconBackgroundColor:h.iconBackgroundColor}:null))}),x(()=>{if(h.type==="svg")return;const{iconSrc:d}=h;if(d){let w=!1;const E=new Image;return E.src=d,E.onload=()=>{w||(u=E,i.value++)},()=>{w=!0}}})});function e(i,u,d,w,E){const a=t.value;if(!a)return;const m=u*$,R=i.size,I=m/R;a.width=m,a.height=m;const p=a.getContext("2d");if(p){p.clearRect(0,0,a.width,a.height);for(let A=0;A<i.size;A++)for(let v=0;v<i.size;v++){p.fillStyle=i.getModule(v,A)?d:w;const S=Math.floor(v*I),P=Math.ceil((v+1)*I),C=Math.floor(A*I),y=Math.ceil((A+1)*I);p.fillRect(S,C,P-S,y-C)}if(E){const{icon:A,iconBackgroundColor:v,iconBorderRadius:S,iconSize:P}=E,C=P*$,y=(a.width-C)/2,z=(a.height-C)/2;p.fillStyle=v,p.beginPath(),p.roundRect(y,z,C,C,S*$),p.fill();const b=A.width/A.height,k=b>=1?C:C*b,H=b<=1?C:C/b,G=y+(C-k)/2,K=z+(C-H)/2;p.drawImage(A,G,K,k,H)}}}function n(i,u=0){const d=[];return i.forEach(function(w,E){let a=null;w.forEach(function(m,R){if(!m&&a!==null){d.push(`M${a+u} ${E+u}h${R-a}v1H${a+u}z`),a=null;return}if(R===w.length-1){if(!m)return;a===null?d.push(`M${R+u},${E+u} h1v1H${R+u}z`):d.push(`M${a+u},${E+u} h${R+1-a}v1H${a+u}z`);return}m&&a===null&&(a=R)})}),d.join("")}function s(i,u,d){const w=i.getModules(),E=w.length,a=w;let m="";const R=`<path fill="transparent" d="M0,0 h${E}v${E}H0z" shape-rendering="crispEdges"></path>`,I=`<path fill="${h.color}" d="${n(a,0)}" shape-rendering="crispEdges"></path>`;let p="";if(d){const{iconSrc:A,iconSize:v}=d,P=Math.floor(u*.1),C=E/u,y=(v||P)*C,z=(v||P)*C,b=w.length/2-z/2,k=w.length/2-y/2;p+=`<image href="${A}" width="${z}" height="${y}" x="${b}" y="${k}" preserveAspectRatio="none"></image>`}return m+=R,m+=I,m+=p,{innerHtml:m,numCells:E}}const f=O(()=>s(o.value,h.size,h.iconSrc?{iconSrc:h.iconSrc,iconBorderRadius:h.iconBorderRadius,iconSize:h.iconSize,iconBackgroundColor:h.iconBackgroundColor}:null));return{canvasRef:t,mergedClsPrefix:r,cssVars:l?void 0:c,themeClass:g==null?void 0:g.themeClass,svgInfo:f}},render(){const{mergedClsPrefix:h,backgroundColor:r,padding:l,cssVars:M,themeClass:c,size:g,type:t}=this;return F("div",{class:[`${h}-qr-code`,c],style:Object.assign({padding:typeof l=="number"?`${l}px`:l,backgroundColor:r,width:`${g}px`,height:`${g}px`},M)},t==="canvas"?F("canvas",{ref:"canvasRef",style:{width:`${g}px`,height:`${g}px`}}):F("svg",{height:g,width:g,viewBox:`0 0 ${this.svgInfo.numCells} ${this.svgInfo.numCells}`,role:"img",innerHTML:this.svgInfo.innerHtml}))}}),V=h=>(nt("data-v-ffd1c5d6"),h=h(),st(),h),Mt={id:"login-qrlogin"},wt=V(()=>Y("span",{style:{"font-size":"1.5rem"}},"扫码登录",-1)),Rt=V(()=>Y("span",{style:{"font-size":"1rem",color:"grey"}},"请使用网易云音乐APP扫码登录",-1)),Ct={key:1},pt={key:2},At={__name:"login",setup(h){let r=j(),l=q(),M=T(""),c=T("等待扫码"),g;_(()=>{t(),r.updateByCookie()}),J(()=>{clearInterval(g)});async function t(){let o=await Z();o=o.data.data.unikey;let e=await Q(o);M.value=e.data.data.qrurl,g=setInterval(()=>{tt(o).then(n=>{n.data.code==800&&(clearInterval(g),c.value="二维码已失效",t()),n.data.code==801&&(c.value="等待扫码"),n.data.code==802&&(c.value="正在授权"),n.data.code==803&&(c.value="授权成功",r.updateByCookie(n.data.cookie),clearInterval(g),l.push({name:"account"}))})},3e3)}return(o,e)=>(L(),D("div",Mt,[wt,Rt,B(M)!=""?(L(),et(B(Et),{key:0,value:B(M),size:200},null,8,["value"])):U("",!0),B(M)==""?(L(),D("span",Ct,"等待生成二维码")):U("",!0),B(M)!=""?(L(),D("span",pt,ot(B(c)),1)):U("",!0)]))}},Pt=it(At,[["__scopeId","data-v-ffd1c5d6"]]);export{Pt as default};
